if (WITH_SYSTEM_LIBRARIES)
  find_package(ZLIB REQUIRED)
endif(WITH_SYSTEM_LIBRARIES)
if (NOT ZLIB_FOUND)
  message(STATUS "Using built-in zlib library")
  set(ZLIB_INCLUDE_DIRS "${EXTDIR}/zlib")
  set(ZLIB_LIBRARY_DIRS "${EXTDIR}/zlib")
  set(ZLIB_LIBRARIES "z")
endif(NOT ZLIB_FOUND)

if (WITH_SYSTEM_LIBRARIES)
  find_package(CURL REQUIRED)
endif(WITH_SYSTEM_LIBRARIES)
if (NOT CURL_FOUND)
  message(STATUS "Using built-in curl library")
  set(CURL_INCLUDE_DIRS "${EXTDIR}/curl/include")
  set(CURL_LIBRARY_DIRS "${EXTDIR}/curl/lib/.libs")
  set(CURL_LIBRARIES "curl")
endif(NOT CURL_FOUND)

if (WITH_SYSTEM_LIBRARIES)
  find_package(JPEG REQUIRED)
endif(WITH_SYSTEM_LIBRARIES)
if (NOT JPEG_FOUND)
  message(STATUS "Using built-in jpeg library")
  set(JPEG_LIBRARY_DIRS "${EXTDIR}/jpg/.libs")
  set(JPEG_INCLUDE_DIRS "${EXTDIR}/jpg")
  set(JPEG_LIBRARIES "jpeg")
endif(NOT JPEG_FOUND)

if (WITH_SYSTEM_LIBRARIES)
  pkg_search_module(TURBO_JPEG libturbojpeg)
endif(WITH_SYSTEM_LIBRARIES)
if (NOT TURBO_JPEG_FOUND)
  message(STATUS "Checking built-in libturbojpeg library")
  set(TURBO_JPEG_INCLUDE_DIRS "${EXTDIR}/libjpeg-turbo")
  set(TURBO_JPEG_LIBRARY_DIRS "${EXTDIR}/libjpeg-turbo/.libs")
  set(TURBO_JPEG_LIBRARIES "turbojpeg")
  find_file(TURBO_JPEG_SO_FILE libturbojpeg.so PATHS ${TURBO_JPEG_LIBRARY_DIRS} NO_DEFAULT_PATH)
endif(NOT TURBO_JPEG_FOUND)

if (TURBO_JPEG_FOUND OR TURBO_JPEG_SO_FILE)
  message(STATUS "Have ENABLE_LIBJPEG_TURBO")
  set(TURBO_DEFINITIONS "-DENABLE_LIBJPEG_TURBO")
endif(TURBO_JPEG_FOUND OR TURBO_JPEG_SO_FILE)

if (WITH_SYSTEM_LIBRARIES)
  find_package(PNG REQUIRED)
endif (WITH_SYSTEM_LIBRARIES)
if (NOT PNG_FOUND)
  message(STATUS "Using built-in libpng library")
  set(PNG_INCLUDE_DIRS "${EXTDIR}/png")
  set(PNG_LIBRARY_DIRS "${EXTDIR}/png/.libs")
  set(PNG_LIBRARIES "png16")
endif(NOT PNG_FOUND)

if (WITH_SYSTEM_LIBRARIES)
  pkg_search_module(FREETYPE REQUIRED freetype2)
endif (WITH_SYSTEM_LIBRARIES)
if (NOT FREETYPE_FOUND)
  message(STATUS "Using built-in freetype2 library")
  set(FREETYPE_INCLUDE_DIRS "${EXTDIR}/ft/include")
  set(FREETYPE_LIBRARY_DIRS "${EXTDIR}/ft/objs/.libs")
  set(FREETYPE_LIBRARIES "freetype")
endif(NOT FREETYPE_FOUND)

set(COMM_DEPS_DEFINITIONS ${COMM_DEPS_DEFINITIONS} ${TURBO_DEFINITIONS})
set(COMM_DEPS_INCLUDE_DIRS ${COMM_DEPS_INCLUDE_DIRS} ${ZLIB_INCLUDE_DIRS} ${CURL_INCLUDE_DIRS} ${JPEG_INCLUDE_DIRS} ${TURBO_JPEG_INCLUDE_DIRS} ${PNG_INCLUDE_DIRS} ${FREETYPE_INCLUDE_DIRS})
set(COMM_DEPS_LIBRARY_DIRS ${COMM_DEPS_LIBRARY_DIRS} ${ZLIB_LIBRARY_DIRS} ${CURL_LIBRARY_DIRS} ${JPEG_LIBRARY_DIRS} ${TURBO_JPEG_LIBRARY_DIRS} ${PNG_LIBRARY_DIRS} ${FREETYPE_LIBRARY_DIRS})
set(COMM_DEPS_LIBRARIES    ${COMM_DEPS_LIBRARIES}    ${ZLIB_LIBRARIES}    ${CURL_LIBRARIES}    ${JPEG_LIBRARIES}    ${TURBO_JPEG_LIBRARIES}    ${PNG_LIBRARIES}    ${FREETYPE_LIBRARIES}   )
